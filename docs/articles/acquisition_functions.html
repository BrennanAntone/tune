<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Acquisition Functions • tune</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../tidyverse-2.css" rel="stylesheet">
<meta property="og:title" content="Acquisition Functions">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- google analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-115082821-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">tune</a>
        <div class="info">
          <span class="partof">part of <a href="https://github.com/tidymodels">tidymodels</a></span>
          <span class="version version-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9001</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting_started.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/grid.html">Grid Search</a>
    </li>
    <li>
      <a href="../articles/acquisition_functions.html">Acquisition Functions</a>
    </li>
    <li>
      <a href="../articles/extras/classification.html">Bayesian Optimization of Classification Model</a>
    </li>
    <li>
      <a href="../articles/extras/optimizations.html">Optimizations and Parallel Processing</a>
    </li>
    <li>
      <a href="../articles/extras/text_analysis.html">Text Analysis Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
        
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Acquisition Functions</h1>
            
      
      
      <div class="hidden name"><code>acquisition_functions.Rmd</code></div>

    </div>

    
    
<p><em>Acquisition functions</em> are mathematical techniques that guide how the parameter space should be explored. These are functions of the predicted mean and variance generated by the Gaussian process model. For a set of such predictions on a set of candidate parameter sets, an acquisition functions weights the means and variances to direct the search.</p>
<p>The variance term that is generated by the Gaussian process model usually reflects the spatial aspects of the data. Candidate sets with high variance are not near any existing parameter values (i.e. those that have observed performance estimates). The predicted variance is very close to zero when at or very near to an existing result.</p>
<p>There is usually a trade-off between two strategies:</p>
<ul>
<li><p><em>exploitation</em> focuses on results at or near to the current best results by penalizing for higher variance values.</p></li>
<li><p><em>exploration</em> pushes the search towards unexplored regions.</p></li>
</ul>
<p>The acquisition functions themselves have quasi-tuning parameters that are usually trade-offs between exploitation and exploration. For example, if the performance measure being used should be maximized (i.e. accuracy, the area under the ROC curve, etc), then one acquisition function would be a lower confidence bound <span class="math inline">\(L = \mu - C \times \sigma\)</span>. The multiplier <span class="math inline">\(C\)</span> would be used to penalize based on the predicted standard error (<span class="math inline">\(\sigma\)</span>) of different parameter combinations. Note that the acquisition function is not the performance measure, but a funtion of what metric is used to evaluate the model.</p>
<p>One of the most common acquisition functions is the <em>expected improvement</em>. Based on basic probability theory, this can be computed relative to the current estimate of the optimal performance (<span class="math inline">\(\hat{f}_{opt}\)</span>). For a arbitrary parameter value <span class="math inline">\(\theta\)</span> with predicted mean <span class="math inline">\(\mu\)</span> and standard error <span class="math inline">\(\sigma\)</span>, the expected improvement is determined using:</p>
<p>Suppose a single parameter were being optimized and that parameter was represented using a log10 transformation. Using resampling, suppose the accuracy results for three points were evaluated:</p>
<p><img src="figures/initial.svg"><!-- --></p>
<p>In the first iteration of Bayesian optimization, these three data points are given to the Gaussian process model to produce predictions across a wider range of values. The fitted curve is shown on the top panel below along with approximate 95% credible intervals:</p>
<p><img src="figures/iter_1.svg"><!-- --></p>
<p>The bottom panel is shows the expected improvement for this range of candidate values. Notice that, for this acquisition function, there is no predicted improvement near the existing points and the three regions that show promise are associated with higher variance but moderate to high predicted accuracies. The region to the right of the highest value are not shown to be promising due to the low predicted mean accuracy.</p>
<p>Using these results, the parameter value with the largest improvement is then evaluated using cross-validation. The GP model is then updated and a new parameter is chosen and so on.</p>
<p>The results at iteration 14 are:</p>
<p><img src="figures/iter_14.svg"><!-- --></p>
<p>The points shown on the graph indicate that there is a region slightly less than a value of 0.01 that appears to produce the best results.</p>
<p>When using expected improvement, the primary method for compromising between exploitation and exploration is the use of a “trade-off” value. This value is the amount of performance (in the original units) that can be sacrificed when computing the improvement. This has the effect of down-playing the contribution of the mean effect in the computations. For a trade-off value <span class="math inline">\(\epsilon\)</span>, the math becomes:</p>
<p>Suppose that we were willing to trade-off 1% of the predicted accuracy during the search? Using the same three initial results, the search would end up in the same general location but would have explored more values to the left of the predicted optimum:</p>
<p><img src="figures/trade_off_14.svg"><!-- --></p>
<p>There are two main strategies for <em>dynamic trade-offs</em> during the optimization:</p>
<ul>
<li><p>Use a function to specify the parameter(s) for the acquisition functions. For expected improvement, this can be done using <code><a href="../reference/prob_improve.html">exp_improve(trade_off = foo())</a></code>. <code>foo()</code> should be a function whose first parameter is the current iteration number. When <code>tune</code> invokes this function, only the first argument is used. A good strategy might be to set <code>trade_off = 0</code> at the start of the search and increase it towards the end.</p></li>
<li><p><code><a href="../reference/Bayes_control.html">Bayes_control()</a></code> has an option for doing an additional <em>uncertainty sample</em> when no improvements have been found. This is a technique from the active learning literature where new data points are sampled that most help the model. In this case, the candidate points are scored only on variance and a candidate is chosen from a set of the <em>most</em> variable design points. This may find a location in the parameter space to help the optimization make improvements.</p></li>
</ul>
</div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="tidyverse">
  <p>tune is a part of the <strong>tidymodels</strong> ecosystem, a collection of modeling packages designed with common APIs and a shared philosophy.</p>
</div>

<div class="author">
  <p>
    Developed by Max Kuhn.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  </body>
</html>
